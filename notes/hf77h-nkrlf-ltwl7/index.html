<!DOCTYPE html><html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile# zotero: http://www.zotero.org/namespaces/export#" lang="en"><head>
        <meta charset="utf-8">

        <title>A globally-available filesystem is a security liability</title>

        <!-- metadata -->

        <meta name="generator" content="Nanoc 4.12.2">

        

        <meta property="og:site_name" content="denisdefreyne.com">

        <meta property="og:url" content="https://denisdefreyne.com/notes/hf77h-nkrlf-ltwl7/">

        <meta property="og:title" content="A globally-available filesystem is a security liability">
        <meta property="dc.title" content="A globally-available filesystem is a security liability">

        <meta property="og:type" content="website">

        

        
            <meta property="og:description" content="A note in Denis’ digital garden.">
        

        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital@0;1&amp;display=swap" rel="stylesheet">

        
            <link rel="stylesheet" href="../../assets/style/reset-x474zZ4mc7j473vXXmQEP4oTpk.css">
            <link rel="stylesheet" href="../../assets/fonts/main.css">
        
        
        <link rel="stylesheet" href="../../assets/style/2021q1-Jr8aVMY4UAbJXWhaaNP4oSGW1x0.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script>
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-15639968-2']);
            _gaq.push(['_trackPageview']);

            (function() {
             var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
             ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
             var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
             })();
        </script>
    </head>

    
    <body>
        <div class="above-footer">
            <nav class="nav">
                <ul>
                    <li><a href="../../">denisdefreyne.com</a></li>
                    <li><a href="../../software/">software</a></li>
                    <li><a href="../../talks/">talks</a></li>
                    <li><a href="../../experiments/">experiments</a></li>
                    <li><a href="../">notes</a></li>
                    <li><a href="../../cv/">cv</a></li>
                </ul>
            </nav>

            <article class="container primary">
                <h1>A globally-available filesystem is a security liability</h1>


<p>Virtually every non-trivial program pulls in third-party libraries. As we, as software/security engineers, have no time to carefully review every third-party library (and its dependencies, and transitive dependencies), we implicitly put a lot of trust in these third-party&nbsp;libraries.</p>

<p>This doesn’t always work out well: think of <a href="https://www.theregister.com/2018/11/26/npm_repo_bitcoin_stealer/">the event-stream incident</a>:</p>

<blockquote>
  <p>A widely used Node.js code library listed in NPM’s warehouse of repositories was altered to include crypto-coin-stealing malware. The lib in question, <em>event-stream</em>, is downloaded roughly two million times a week by application&nbsp;programmers.</p>
</blockquote>

<p>If an application can access the filesystem, then the third-party libraries can too, because the filesystem is typically globally&nbsp;available.</p>

<p>It is typically not possible to give restricted access to a third-party&nbsp;library.</p>

<p>Sandboxing doesn’t solve this problem, because if your application has access to the filesystem, all (transitively) dependent packages automatically have access to the filesystem as&nbsp;well.</p>

<h2 id="dependency-injection-as-a-possible-solution">Dependency injection as a possible&nbsp;solution</h2>
<p>A solution would be to not make the filesystem globally available, but only in the application’s entry point, and allow a reference to the filesystem to be passed to functions (including ones in third-party libraries) that need&nbsp;it.</p>

<p>This is dependency injection used from a security&nbsp;angle.</p>

<p>This way, a third-party library would only be able to access the filesystem when it is explicitly passed in. A third-party library wouldn’t by default be able to encrypt your hard drive or read your Bitcoin&nbsp;wallet.</p>

<p>This could be made more fine-grained: rather than injecting a reference to the entire filesystem, a reference to a directory or to a specific file could be injected. This way, a third-party library could be granted limited access to exactly what it needs to operate&nbsp;properly.</p>

<h2 id="references">References</h2>
<p>Francisco, Thomas Claburn in San. n.d. “Check Your Repos… Crypto-Coin-Stealing Code Sneaks into Fairly Popular NPM Lib (2m Downloads per Week).” Accessed March 7, 2021. <a href="https://www.theregister.com/2018/11/26/npm_repo_bitcoin_stealer/">https://www.theregister.com/2018/11/26/npm_repo_bitcoin_stealer/</a>.</p>

<p>“Npm Blog Archive: Details about the Event-Stream Incident.” n.d. Accessed March 7, 2021. <a href="https://blog.npmjs.org/post/180565383195/details-about-the-event-stream-incident">https://blog.npmjs.org/post/180565383195/details-about-the-event-stream-incident</a>.</p>


<div class="hr"></div>

<div class="col-left-sm main-footer muted">
  <div>Last revised:</div>
  <div class="pb-base">April 2021</div>
</div>

<div class="col-center-sm main-footer muted">
  
    <div>Backlinks:</div>
    <ul class="pb-base">
      
        <li><a href="../wtc9r-khvlc-rxfc9/">The filesystem is global mutable state</a></li>
      
    </ul>
  
</div>

            </article>
        </div>

        <footer class="footer muted">
            <div>© 2007–2021</div>
            <div>made in Berlin</div>
        </footer>
    


    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>


</body></html>