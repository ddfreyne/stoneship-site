<!DOCTYPE html><html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile# zotero: http://www.zotero.org/namespaces/export#" lang="en"><head>
        <meta charset="utf-8">

        <title>What would I change about Ruby?</title>

        <!-- metadata -->

        <meta name="generator" content="Nanoc 4.12.2">

        

        <meta property="og:site_name" content="denisdefreyne.com">

        <meta property="og:url" content="https://denisdefreyne.com/notes/hfkcz-pwnmm-czpxx/">

        <meta property="og:title" content="What would I change about Ruby?">
        <meta property="dc.title" content="What would I change about Ruby?">

        <meta property="og:type" content="website">

        

        
            <meta property="og:description" content="A note in Denis’ digital garden.">
        

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital@0;1&amp;display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">

        
            <link rel="stylesheet" href="../../assets/style/reset-x474zZ4mc7j473vXXmQEP4oTpk.css">
            <link rel="stylesheet" href="../../assets/fonts/main.css">
        
        
        <link rel="stylesheet" href="../../assets/style/note-Y1Zf231gCi3P1caq8mb8AVvVds.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="alternate" type="application/atom+xml" href="../../feed.xml" title="Atom feed for denisdefreyne.com articles">

        <script>
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-15639968-2']);
            _gaq.push(['_trackPageview']);

            (function() {
             var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
             ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
             var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
             })();
        </script>
    </head>

    
  <body><div class="py-3 px-3 pos-fixed bg-root border-b-1-gray-200 dark:border-b-1-gray-700 z-100 w-100">// <a href="../../">denisdefreyne.com</a> / <a href="../">notes</a></div>

  <div class="wrapper pt-5 pb-4 px-3">
    <div>
      <div class="sidenote text-muted font-normal pt-3">
        
          <div class="pt-2">Last revised:</div>
          <div class="pb-3">May 2021</div>
        

        
          <div class="">Backlinks:</div>
          <div class="pb-3 text-indent-inverted">
            
              <div><a href="../tvtfx-rkvxx-tm9px/">What would I change about programming language X?</a></div>
            
          </div>
        
      </div>
    </div>

    <h1>What would I change about Ruby?</h1>

    
<p>Ruby is close to my favorite programming language. That does not mean I’m entirely happy with it. As an exercise, I’m writing up what I’d change about the&nbsp;language.</p>

<p>This is purely hypothetical — the thought of forking Ruby and making change is preposterous. But it is an interesting&nbsp;exercise!</p>

<p>Ruby was created in the mid-90’s. It’s now 25 years later, and there have been plenty of advances in programming languages, and the best practices around Ruby have emerged and mostly solidified. This creates a good opportunity to look back and&nbsp;reflect.</p>

<h2 id="remove-symbols">Remove&nbsp;symbols</h2>
<p>Symbols and (frozen) strings are too similar to warrant a distinction between the&nbsp;two.<span class="sidenote-pre text-muted"> (</span><span class="sidenote text-muted">Clojure has symbols and (immutable) strings, <em>and</em> keywords on top of that. Keywords are similar to immutable strings, but can be namedspaced (e.g. <code>::foo</code> is similar to <code>:my.namespace/foo</code>).&nbsp;</span><span class="sidenote-post text-muted">)</span></p>

<p><mark><strong>To do</strong>: Ooh, potentially plenty of implications of this.
</mark></p>

<h2 id="use-one-in-memory-string-encoding">Use one in-memory string&nbsp;encoding</h2>
<p>Always encode strings as UTF-8. Provide a “data array” class to contain arbitrary data, and allow converting between strings and data,&nbsp;e.g.</p>

<pre><code class="language-ruby">"stuff".to_data(encoding: "UTF-8")
</code></pre>

<pre><code class="language-ruby">some_data.decode_string(encoding: "UTF-8")
</code></pre>

<h2 id="use-distinct-character-literal">Use distinct character&nbsp;literal</h2>
<p>For strings, Ruby can use single quotes (e.g. <code>'example'</code>), double quotes (e.g. <code>"example"</code>), and percent-literal syntax (e.g. <code>%[example]</code>). The ?-syntax can be used to construct single-character strings (e.g. <code>?x</code> which is identical to <code>"x"</code>).</p>

<p>I believe character literals are useful, and other languages gravitate towards using single quotes for&nbsp;those.</p>

<pre><code class="language-plaintext">first_name = "Denis"

# This is a character literal, not a string
first_name[0] # =&gt; 'D'

# This is a string, built from two character literals
'D' + 'e' # =&gt; "De"
</code></pre>

<h2 id="change-keyword-for-defining-functions-and-methods">Change keyword for defining functions and&nbsp;methods</h2>
<p>A small one, but <code>def</code> always strikes me as odd: you can’t use it for defining anything but functions and methods. Perhaps <code>fn</code> or <code>fun</code>&nbsp;instead?</p>

<pre><code class="language-plaintext">class Person
  fun initialize(name)
    @name = name
  end
end
</code></pre>

<h2 id="rename-initializer-method">Rename initializer&nbsp;method</h2>
<p>Ruby’s constructor is called <code>initialize</code>,&nbsp;e.g.</p>

<pre><code class="language-ruby">class Person
  def initialize(name)
    @name = name
  end
end
</code></pre>

<p>I find it difficult to type <code>initialize</code>, and often make typos when typing it, which leads to hard-to-debug problems because the initializer does not&nbsp;exist.</p>

<p>Perhaps renaming it to <code>init</code> could work. Or <code>construct</code> (like in&nbsp;JavaScript).</p>

<p>Or, taking a page from Python’s book, using a clearly reserved name such as <code>__init__</code><span class="sidenote-pre text-muted"> (</span><span class="sidenote text-muted"><code>__init__</code> is an identifier, not a keyword. What would that mean for other identifiers that are not keywords? Would we have <code>__self__</code> instead of <code>self</code>?&nbsp;</span><span class="sidenote-post text-muted">)</span>. This would allow the interpreter to detect typos: an unknown reserved name could be an&nbsp;error.</p>

<pre><code class="language-plaintext">class Person
  def __init__(name)
    @name = name
  end
end
</code></pre>

<p>Ruby already uses the double-underscore approach in some cases: <code>__FILE__</code>, <code>__dir__</code>, <code>__method__</code> and <code>__callee__</code>. Interestingly, these are implemented as methods on <code>Kernel</code> — except <code>__FILE__</code>, which is a constant, and that explains the rather unfortunate inconsistency in&nbsp;capitalisation.</p>

<h2 id="simplify-assignment-in-initializer">Simplify assignment in&nbsp;initializer</h2>
<p>Ruby’s initializer is verbose and repetitive when passing in many&nbsp;values:</p>

<pre><code class="language-ruby">class Person
  def initialize(first_name)
    @first_name = first_name
  end
end
</code></pre>

<p>I rather like Crystal’s approach, providing a&nbsp;shorthand:</p>

<pre><code class="language-plaintext">class Person
  def initialize(@first_name)
  end
end
</code></pre>

<p><mark><strong>To do</strong>: It looks weird that the initialize method is now empty.
</mark></p>

<h2 id="treat-modules-are-files">Treat modules are&nbsp;files</h2>
<p>Ruby is not prescriptive in how to organise code. Over time, though, conventions have appeared: <a href="https://github.com/fxn/zeitwerk">Zeitwerk</a>, for example, defines a <a href="https://github.com/fxn/zeitwerk#file-structure">file structure</a> that is mostly&nbsp;sensible.</p>

<p>I’d like to have that more tightly integrated into the language. <mark><strong>To do</strong>: OK, but… how would that work exactly?
</mark></p>

<p><mark><strong>To do</strong>: Then we can remove most of the indentation caused by nesting, which makes the code less rightward.
</mark></p>

<h2 id="make-modules-not-globally-available">Make modules not globally&nbsp;available</h2>
<p><mark><strong>To do</strong>: Ugh this is a big one
</mark></p>

<h2 id="simplify-procs-blocks-and-lambdas">Simplify procs, blocks and&nbsp;lambdas</h2>
<p><mark><strong>To do</strong>
</mark></p>

<p><mark><strong>To do</strong>: Blocks are useful (distinct from functions) because they support non-local return.
</mark></p>


  </div>


    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>


</body></html>